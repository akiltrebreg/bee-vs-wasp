# üêù Bee vs Wasp Classification

–ü—Ä–æ–µ–∫—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞—Å–µ–∫–æ–º—ã—Ö –Ω–∞ —á–µ—Ç—ã—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**: —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—É—é
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—Å–µ–∫–æ–º—ã—Ö –Ω–∞ —á–µ—Ç—ã—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –ø—á–µ–ª–∞,
–æ—Å–∞, –¥—Ä—É–≥–æ–µ –Ω–∞—Å–µ–∫–æ–º–æ–µ, –ø—Ä–æ—á–µ–µ.

–¢–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è —Ä—É—á–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø–æ–≤—ã—Å–∏—Ç—å
—Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–ª–µ–≤—ã–º–∏ –∏–ª–∏ –ª—é–±–∏—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏.

–ó–∞ –æ—Å–Ω–æ–≤—É –ø—Ä–æ–µ–∫—Ç–∞ –≤–∑—è—Ç
[–Ω–æ—É—Ç–±—É–∫ —Å Kaggle](https://www.kaggle.com/code/erntkn/pytorch-starter-with-resnet18).

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- **–§–æ—Ä–º–∞—Ç**: RGB-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **–†–∞–∑–º–µ—Ä**: –ª—é–±–æ–µ –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ 224√ó224
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**:
  - `mean = (0.485, 0.456, 0.406)`
  - `std = (0.229, 0.224, 0.225)`
- **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏** (–≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è):
  - `RandomResizedCrop(224)`
  - `RandomHorizontalFlip()`

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- **–§–æ—Ä–º–∞—Ç**: –í–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—Ç–æ–≤
- **–ö–ª–∞—Å—Å—ã**: –ü–æ—Å–ª–µ `argmax` –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ {0, 1, 2, 3}

| –ß–∏—Å–ª–æ | –ö–ª–∞—Å—Å       |
| ----- | ----------- |
| 0     | bee         |
| 1     | wasp        |
| 2     | otherinsect |
| 3     | other       |

## –ú–µ—Ç—Ä–∏–∫–∏

- **Accuracy**: –í–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—Ç–æ–≤
- **F1-score (macro)**: –ü–æ—Å–ª–µ `argmax` –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ {0, 1, 2,
  3}

## –î–∞—Ç–∞—Å–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç
[Bees vs Wasps](https://www.kaggle.com/datasets/jerzydziewierz/bee-vs-wasp) —Å
Kaggle.

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è   | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
| ----------- | ---------------------- |
| bee         | 3 183                  |
| wasp        | 4 943                  |
| otherinsect | 2 453                  |
| other       | 845                    |
| **–í—Å–µ–≥–æ**   | **12 424**             |

### –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏

| –¢–∏–ø –≤—ã–±–æ—Ä–∫–∏            | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
| ---------------------- | ---------------------- |
| Training               | 7 942                  |
| Validation (1st-level) | 1 719                  |
| Final validation       | 1 763                  |

–†–∞–∑–±–∏–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–æ —è–≤–Ω–æ –≤ `labels.csv` —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏ `is_validation` –∏
`is_final_validation`.

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- **–°–º–µ—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—á–µ–ª —Å—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ü–≤–µ—Ç–∫–µ, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ
  –æ—Å - –±–µ–∑ —Ü–≤–µ—Ç–∫–æ–≤
- **–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: –ö–ª–∞—Å—Å `other` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–µ–Ω—å—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö,
  –∫–ª–∞—Å—Å `wasp` –Ω–∞ 1 760 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–æ–ª—å—à–µ —á–µ–º `bee`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–µ–π–∑–ª–∞–π–Ω

- **SimpleCNN**: –ü—Ä–æ—Å—Ç–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å —Å 4 –±–ª–æ–∫–∞–º–∏ (Conv + ReLU +
  BatchNorm + MaxPool)

### –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å

- **ResNet18**: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ImageNet –º–æ–¥–µ–ª—å –∏–∑ torchvision
- **Fine-tuning**: –ó–∞–º–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ fully-connected —Å–ª–æ—è –Ω–∞ 4-–∫–ª–∞—Å—Å–æ–≤—ã–π
  –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

- **–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä**: SGD
  - Learning rate: 0.001
  - Momentum: 0.9
- **Loss**: CrossEntropyLoss
- **–≠–ø–æ—Ö–∏**: 15
- **Batch size**: 32
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: PyTorch Lightning

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏**: uv
- **–û–±—É—á–µ–Ω–∏–µ**: PyTorch Lightning
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: MLflow
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏**: DVC
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: Hydra
- **CLI**: Fire
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**: Ruff + pre-commit

---

## Setup

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd bee-vs-wasp
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv

#### macOS / Linux

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

#### Windows

```bash
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ —á–µ—Ä–µ–∑ pip

```bash
pip install uv
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
uv sync
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ pre-commit —Ö—É–∫–æ–≤

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pre-commit —Ö—É–∫–æ–≤

```bash
uv run pre-commit install
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
uv run pre-commit run --all-files
```
