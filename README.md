# üêù Bee vs Wasp Classification

–ü—Ä–æ–µ–∫—Ç –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞—Å–µ–∫–æ–º—ã—Ö –Ω–∞ —á–µ—Ç—ã—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏](#–ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞-–∑–∞–¥–∞—á–∏)
- [–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö](#—Ñ–æ—Ä–º–∞—Ç-–≤—Ö–æ–¥–Ω—ã—Ö-–∏-–≤—ã—Ö–æ–¥–Ω—ã—Ö-–¥–∞–Ω–Ω—ã—Ö)
  - [–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ](#–≤—Ö–æ–¥–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ)
  - [–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ](#–≤—ã—Ö–æ–¥–Ω—ã–µ-–¥–∞–Ω–Ω—ã–µ)
- [–ú–µ—Ç—Ä–∏–∫–∏](#–º–µ—Ç—Ä–∏–∫–∏)
- [–î–∞—Ç–∞—Å–µ—Ç](#–¥–∞—Ç–∞—Å–µ—Ç)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [Setup](#setup)
- [Train](#train)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [Development](#development)
- [–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å](#–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞**: —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—É—é
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞—Å–µ–∫–æ–º—ã—Ö –Ω–∞ —á–µ—Ç—ã—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –ø—á–µ–ª–∞,
–æ—Å–∞, –¥—Ä—É–≥–æ–µ –Ω–∞—Å–µ–∫–æ–º–æ–µ, –ø—Ä–æ—á–µ–µ.

–¢–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è —Ä—É—á–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø–æ–≤—ã—Å–∏—Ç—å
—Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–ª–µ–≤—ã–º–∏ –∏–ª–∏ –ª—é–±–∏—Ç–µ–ª—å—Å–∫–∏–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏.

–ó–∞ –æ—Å–Ω–æ–≤—É –ø—Ä–æ–µ–∫—Ç–∞ –≤–∑—è—Ç
[–Ω–æ—É—Ç–±—É–∫ —Å Kaggle](https://www.kaggle.com/code/erntkn/pytorch-starter-with-resnet18).

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- **–§–æ—Ä–º–∞—Ç**: RGB-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **–†–∞–∑–º–µ—Ä**: –ª—é–±–æ–µ –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ 224√ó224
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**:
  - `mean = (0.485, 0.456, 0.406)`
  - `std = (0.229, 0.224, 0.225)`
- **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏** (–≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è):
  - `RandomResizedCrop(224)`
  - `RandomHorizontalFlip()`

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- **–§–æ—Ä–º–∞—Ç**: –í–µ–∫—Ç–æ—Ä –ª–æ–≥–∏—Ç–æ–≤
- **–ö–ª–∞—Å—Å—ã**: –ü–æ—Å–ª–µ `argmax` –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ {0, 1, 2, 3}

| –ß–∏—Å–ª–æ | –ö–ª–∞—Å—Å       |
| ----- | ----------- |
| 0     | bee         |
| 1     | wasp        |
| 2     | otherinsect |
| 3     | other       |

## –ú–µ—Ç—Ä–∏–∫–∏

- **Accuracy (–¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π)** –û—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∞—è –¥–æ–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –±—ã–ª–∞ –æ—Ç–Ω–µ—Å–µ–Ω–∞ –º–æ–¥–µ–ª—å—é –∫ –≤–µ—Ä–Ω–æ–º—É
  –∫–ª–∞—Å—Å—É (–ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `argmax` –∫ –≤—ã—Ö–æ–¥–Ω—ã–º –ª–æ–≥–∏—Ç–∞–º).

  **–¶–µ–ª—å:** –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

- **F1-score (macro)** –£—Å—Ä–µ–¥–Ω—ë–Ω–Ω–∞—è F1-–º–µ—Ä–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º –±–µ–∑ —É—á—ë—Ç–∞ –∏—Ö
  –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É **—Ç–æ—á–Ω–æ—Å—Ç—å—é (precision)** –∏ **–ø–æ–ª–Ω–æ—Ç–æ–π
  (recall)** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–∞ –≤ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö —Å
  ¬´—Ç—Ä—É–¥–Ω—ã–º–∏¬ª –∏–ª–∏ –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `otherinsect` –∏–ª–∏ `other`).

## –î–∞—Ç–∞—Å–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç
[Bees vs Wasps](https://www.kaggle.com/datasets/jerzydziewierz/bee-vs-wasp) —Å
Kaggle.

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è   | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
| ----------- | ---------------------- |
| bee         | 3 183                  |
| wasp        | 4 943                  |
| otherinsect | 2 453                  |
| other       | 845                    |
| **–í—Å–µ–≥–æ**   | **12 424**             |

### –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏

| –¢–∏–ø –≤—ã–±–æ—Ä–∫–∏            | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |
| ---------------------- | ---------------------- |
| Training               | 7 942                  |
| Validation (1st-level) | 1 719                  |
| Final validation       | 1 763                  |

–†–∞–∑–±–∏–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–æ —è–≤–Ω–æ –≤ `labels.csv` —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥–∏ `is_validation` –∏
`is_final_validation`.

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- **–°–º–µ—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—á–µ–ª —Å—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ü–≤–µ—Ç–∫–µ, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ
  –æ—Å - –±–µ–∑ —Ü–≤–µ—Ç–∫–æ–≤
- **–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: –ö–ª–∞—Å—Å `other` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –º–µ–Ω—å—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö,
  –∫–ª–∞—Å—Å `wasp` –Ω–∞ 1 760 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–æ–ª—å—à–µ, —á–µ–º `bee`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–µ–π–∑–ª–∞–π–Ω

- **SimpleCNN**: –ü—Ä–æ—Å—Ç–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å —Å 4 –±–ª–æ–∫–∞–º–∏ (Conv + ReLU +
  BatchNorm + MaxPool)

### –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å

- **ResNet18**: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ ImageNet –º–æ–¥–µ–ª—å –∏–∑ torchvision
- **Fine-tuning**: –ó–∞–º–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ fully-connected —Å–ª–æ—è –Ω–∞ 4-–∫–ª–∞—Å—Å–æ–≤—ã–π
  –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

- **–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä**: SGD
  - Learning rate: 0.001
  - Momentum: 0.9
- **Loss**: CrossEntropyLoss
- **–≠–ø–æ—Ö–∏**: 15
- **Batch size**: 32
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: PyTorch Lightning

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏**: uv
- **–û–±—É—á–µ–Ω–∏–µ**: PyTorch Lightning
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: MLflow
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏**: DVC
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: Hydra
- **CLI**: Fire
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**: Ruff + pre-commit

---

## Setup

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd bee-vs-wasp
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
uv sync
```

### 3. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö pre-commit —Ö—É–∫–æ–≤

```bash
uv run pre-commit run --a
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MLflow (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç–µ MLflow UI:

```bash
uvx --python 3.12 mlflow server --host 127.0.0.1 --port 8080
```

## Train

### –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ

–ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (ResNet18, 15 —ç–ø–æ—Ö):

```bash
uv run python commands.py train
```

### –û–±—É—á–µ–Ω–∏–µ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ SimpleCNN

```bash
uv run python commands.py train model=simple_cnn
```

–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏)

```bash
uv run python commands.py train \
  num_epochs=1 \
  model=simple_cnn \
  data.batch_size=8
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –ú–æ–¥–µ–ª–∏ (`model=`)

- `resnet` - ResNet18 —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `simple_cnn` - –õ–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è CNN

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö (`data.*`)

- `data.batch_size` - –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 32)
- `data.num_workers` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 4)
- `data.dataset_root` - –ü—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ./data)

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏ (`model.*`)

- `model.lr` - Learning rate (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.001)
- `model.momentum` - Momentum –¥–ª—è SGD (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.9)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:

- **–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –≤ `models/<architecture>_<timestamp>.pth`
- **–ú–µ—Ç—Ä–∏–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è** –≤ MLflow (–ø–∞–ø–∫–∞ `mlartifacts/` –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  `mlflow.db`)
- **–õ–æ–≥–∏ Hydra** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `outputs/<date>/<time>/`

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ MLflow

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://127.0.0.1:8080/

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

- –ì—Ä–∞—Ñ–∏–∫ train_loss, val_loss
- –ú–µ—Ç—Ä–∏–∫–∏ train_acc, val_acc, train_f1, val_f1
- –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
- Git commit ID –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
bee-vs-wasp/
‚îú‚îÄ‚îÄ bee_vs_wasp/               # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ data.py                # Lightning DataModule
‚îÇ   ‚îú‚îÄ‚îÄ model.py               # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ module.py              # Lightning Module
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing.py       # –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –∏ Dataset
‚îÇ   ‚îî‚îÄ‚îÄ train.py               # Training pipeline
‚îú‚îÄ‚îÄ conf/                      # Hydra –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml            # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
‚îÇ   ‚îú‚îÄ‚îÄ data/                  # –ö–æ–Ω—Ñ–∏–≥–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ model/                 # –ö–æ–Ω—Ñ–∏–≥–∏ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ train/                 # –ö–æ–Ω—Ñ–∏–≥–∏ –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ commands.py                # Fire CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ data.dvc                   # DVC-—Ç—Ä–µ–∫–µ—Ä –¥–∞–Ω–Ω—ã—Ö (–æ–ø–∏—Å–∞–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
‚îú‚îÄ‚îÄ .dvc/                      # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ–∞–π–ª—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DVC
‚îú‚îÄ‚îÄ .dvcignore                 # –§–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ DVC
‚îú‚îÄ‚îÄ pyproject.toml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ uv.lock                    # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ .pre-commit-config.yaml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pre-commit —Ö—É–∫–æ–≤
‚îú‚îÄ‚îÄ .gitignore                 # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ Git —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
‚îú‚îÄ‚îÄ LICENSE                    # –õ–∏—Ü–µ–Ω–∑–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

---

## Development

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

#### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö pre-commit —Ö—É–∫–æ–≤

```bash
uv run pre-commit run --all-files
```

#### –¢–æ–ª—å–∫–æ Ruff –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
uv run ruff check .
```

#### Ruff —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
uv run ruff format .
```

#### –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

```bash
uv run ruff check --fix .
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

```bash
uv add <package-name>
```

#### –î–æ–±–∞–≤–∏—Ç—å dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å

```bash
uv add --dev <package-name>
```

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
uv sync
```

---

## –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

–î–ª—è –ø–æ–ª–Ω–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

1. **–í–µ—Ä—Å–∏—è –∫–æ–¥–∞**: –ö–∞–∂–¥—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ª–æ–≥–∏—Ä—É–µ—Ç Git commit ID –≤ MLflow
2. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ `uv.lock`
3. **–î–∞–Ω–Ω—ã–µ**: –í–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ DVC
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Hydra outputs
5. **Random seed**: –ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–°–º. —Ñ–∞–π–ª [LICENSE](LICENSE)
